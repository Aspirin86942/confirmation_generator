银行询证函自动生成系统项目文档

概述
本项目实现从Excel模板数据自动生成标准银行询证函Word文档，并支持转换为PDF格式。适用于会计师事务所、金融机构等需要批量处理银行询证业务的场景。

功能特性
• 📁 Excel数据读取：支持多sheet页数据读取

• 📑 Word文档生成：自动填充四类银行业务信息

  • 银行存款

  • 银行借款

  • 销户账户

  • 委托贷款

• 📤 格式转换：批量将Word文档转为PDF格式

• 🔢 智能格式处理：自动处理金额、日期、百分比等数据格式

• 🔀 多账户处理：支持同一银行多个账户的合并生成


系统依赖
• Python 3.7+

• 必需库：

  ```bash
  pip install xlrd python-docx comtypes
  ```
• 系统要求：

  • Windows系统（需要调用Word组件）

  • 已安装Microsoft Office Word


文件结构
```
├── input.xlsx                # 数据源文件
├── 银行询证函(模板).docx      # Word模板文件
├── word版函证/               # 生成的Word文档
├── pdf版函证/                # 生成的PDF文档
└── main.py                   # 主程序
```

使用说明

准备数据
1. 按模板格式填写input.xlsx，包含四个sheet页：
   • 银行存款

   • 银行借款

   • 银行销户

   • 本公司作为贷款方的委托贷款


2. 必填字段说明：
   ```python
   {
     "索引号": "唯一标识码",     # 关键索引字段
     "银行名称": "XX银行支行",
     "年度": "2023",
     "账户（公司）名称": "公司全称",
     "银行账号": "123456789",
     "余额": 1000000.00        # 自动添加千分位
   }
   ```

运行程序
```bash
python main.py
```

输出结果
• 生成的Word文档保存在 `./word版函证/`

• 生成的PDF文档保存在 `./pdf版函证/`


代码结构

核心类说明

1. ReadExcel
• 功能：读取并解析Excel数据

• 方法：

  • `read_excel()`: 读取指定sheet页数据

  • `distinct_excel()`: 获取唯一索引号列表

  • `make_table()`: 按索引号生成对应数据表


2. MakeWord
• 功能：生成Word文档

• 特性：

  • 自动扩展表格行数

  • 多表格智能填充

  • 基础信息自动替换

• 处理流程：

  1. 初始化文档模板
  2. 按业务类型填充表格
  3. 格式化关键数据
  4. 保存生成文件

3. Word2Pdf
• 功能：文档格式转换

• 技术：通过COM接口调用Word组件


4. Assemble
• 工具类：提供静态处理方法

  • 文本替换

  • 金额格式化（千分位）

  • 日期格式转换

  • 百分比处理

  • 目录创建


数据处理规则

格式转换标准
| 字段类型   | 处理规则                     | 示例                |
|------------|------------------------------|---------------------|
| 金额       | 自动添加千分位，保留两位小数 | 1234567.89 → 1,234,567.89 |
| 日期       | 转换为YYYY-MM-DD格式         | 44562 → 2022-01-01 |
| 百分比     | 保留四位小数加百分号         | 0.0523 → 5.2300%   |
| 利率字段   | 支持"活期"特殊值             | -                   |

注意事项
1. Excel日期字段需保持数字格式
2. 模板文件中需预先定义好书签：
   • 数据1 ~ 数据5

3. 同一索引号的多sheet数据会合并生成
4. 生成的Word文档名称与索引号对应

授权信息
本项目采用 MIT 开源协议，可自由修改和分发。使用office组件转换PDF需确保拥有合法授权。

---
> 提示：运行前请关闭已打开的Word程序，避免COM接口冲突